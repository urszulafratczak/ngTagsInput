/*! ngTagsInput v3.0.0 License: MIT */!function(){"use strict";var a={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,left:37,right:39,delete:46,comma:188},b=9007199254740991,c=["text","email","url"],d=angular.module("ngTagsInput",[]);d.directive("tagsInput",["$timeout","$document","$window","tagsInputConfig","tiUtil",function(d,e,f,g,h){function i(a,b,c,d){var f,g,i,e={};return f=function(b){return h.safeToString(b[a.displayProperty])},g=function(b,c){b[a.displayProperty]=c},i=function(b){var d=f(b);return d&&d.length>=a.minLength&&d.length<=a.maxLength&&a.allowedTagsPattern.test(d)&&!h.findInObjectArray(e.items,b,a.keyProperty||a.displayProperty)&&c({$tag:b})},e.items=[],e.addText=function(a){var b={};return g(b,a),e.add(b)},e.add=function(c){var d=f(c);return a.replaceSpacesWithDashes&&(d=h.replaceSpacesWithDashes(d)),g(c,d),i(c)?(e.items.push(c),b.trigger("tag-added",{$tag:c})):d&&b.trigger("invalid-tag",{$tag:c}),c},e.remove=function(a){var c=e.items[a];if(d({$tag:c}))return e.items.splice(a,1),e.clearSelection(),b.trigger("tag-removed",{$tag:c}),c},e.select=function(a){a<0?a=e.items.length-1:a>=e.items.length&&(a=0),e.index=a,e.selected=e.items[a]},e.selectPrior=function(){e.select(--e.index)},e.selectNext=function(){e.select(++e.index)},e.removeSelected=function(){return e.remove(e.index)},e.clearSelection=function(){e.selected=null,e.index=-1},e.clearSelection(),e}function j(a){return c.indexOf(a)!==-1}return{restrict:"E",require:"ngModel",scope:{tags:"=ngModel",text:"=?",onTagAdding:"&",onTagAdded:"&",onInvalidTag:"&",onTagRemoving:"&",onTagRemoved:"&",onTagClicked:"&"},replace:!1,transclude:!0,templateUrl:"ngTagsInput/tags-input.html",controller:["$scope","$attrs","$element",function(a,c,d){a.events=h.simplePubSub(),g.load("tagsInput",a,c,{template:[String,"ngTagsInput/tag-item.html"],type:[String,"text",j],placeholder:[String,"Add a tag"],tabindex:[Number,null],removeTagSymbol:[String,String.fromCharCode(215)],replaceSpacesWithDashes:[Boolean,!0],minLength:[Number,3],maxLength:[Number,b],addOnEnter:[Boolean,!0],addOnSpace:[Boolean,!1],addOnComma:[Boolean,!0],addOnBlur:[Boolean,!0],addOnPaste:[Boolean,!1],pasteSplitPattern:[RegExp,/,/],allowedTagsPattern:[RegExp,/.+/],enableEditingLastTag:[Boolean,!1],minTags:[Number,0],maxTags:[Number,b],displayProperty:[String,"text"],keyProperty:[String,""],allowLeftoverText:[Boolean,!1],addFromAutocompleteOnly:[Boolean,!1],spellcheck:[Boolean,!0]}),a.tagList=new i(a.options,a.events,h.handleUndefinedResult(a.onTagAdding,!0),h.handleUndefinedResult(a.onTagRemoving,!0)),this.registerAutocomplete=function(){var b=d.find("input");return{addTag:function(b){return a.tagList.add(b)},focusInput:function(){b[0].focus()},getTags:function(){return a.tagList.items},getCurrentTagText:function(){return a.newTag.text()},getOptions:function(){return a.options},on:function(b,c){return a.events.on(b,c),this}}},this.registerTagItem=function(){return{getOptions:function(){return a.options},removeTag:function(b){a.disabled||a.tagList.remove(b)}}}}],link:function(b,c,g,i){var p,j=[a.enter,a.comma,a.space,a.backspace,a.delete,a.left,a.right],k=b.tagList,l=b.events,m=b.options,n=c.find("input"),o=["minTags","maxTags","allowLeftoverText"];p=function(){i.$setValidity("maxTags",k.items.length<=m.maxTags),i.$setValidity("minTags",k.items.length>=m.minTags),i.$setValidity("leftoverText",!(!b.hasFocus&&!m.allowLeftoverText)||!b.newTag.text())},i.$isEmpty=function(a){return!a||!a.length},b.newTag={text:function(a){return angular.isDefined(a)?(b.text=a,void l.trigger("input-change",a)):b.text||""},invalid:null},b.track=function(a){return a[m.keyProperty||m.displayProperty]},b.$watch("tags",function(a){a?(k.items=h.makeObjectArray(a,m.displayProperty),b.tags=k.items):k.items=[]}),b.$watch("tags.length",function(){p(),i.$validate()}),g.$observe("disabled",function(a){b.disabled=a}),b.eventHandlers={input:{keydown:function(a){l.trigger("input-keydown",a)},click:function(a){b.hasFocus||(b.hasFocus=!1,l.trigger("input-blur")),b.hasFocus=!0,l.trigger("input-click",a)},focus:function(){b.hasFocus||(b.hasFocus=!1,l.trigger("input-blur")),b.hasFocus=!0,l.trigger("input-focus")},blur:function(){d(function(){var a=e.prop("activeElement"),d=a===n[0],f=c[0].contains(a);!d&&f||(b.hasFocus=!1,l.trigger("input-blur"))})},paste:function(a){a.getTextData=function(){var b=a.clipboardData||a.originalEvent&&a.originalEvent.clipboardData;return b?b.getData("text/plain"):f.clipboardData.getData("Text")},l.trigger("input-paste",a)}},host:{click:function(){b.disabled||n[0].focus()}},tag:{click:function(a){l.trigger("tag-clicked",{$tag:a})}}},l.on("tag-added",b.onTagAdded).on("invalid-tag",b.onInvalidTag).on("tag-removed",b.onTagRemoved).on("tag-clicked",b.onTagClicked).on("tag-added",function(){b.newTag.text("")}).on("tag-added tag-removed",function(){b.tags=k.items,i.$setDirty()}).on("invalid-tag",function(){b.newTag.invalid=!0}).on("option-change",function(a){o.indexOf(a.name)!==-1&&p()}).on("input-change",function(){k.clearSelection(),b.newTag.invalid=null}).on("click",function(){c.triggerHandler("click")}).on("input-focus",function(){c.triggerHandler("focus"),i.$setValidity("leftoverText",!0)}).on("input-blur",function(){m.addOnBlur&&!m.addFromAutocompleteOnly&&k.addText(b.newTag.text()),c.triggerHandler("blur"),p()}).on("input-keydown",function(c){var f,g,i,l,d=c.keyCode,e={};if(!h.isModifierOn(c)&&j.indexOf(d)!==-1){if(e[a.enter]=m.addOnEnter,e[a.comma]=m.addOnComma,e[a.space]=m.addOnSpace,f=!m.addFromAutocompleteOnly&&e[d],g=(d===a.backspace||d===a.delete)&&k.selected,l=d===a.backspace&&0===b.newTag.text().length&&m.enableEditingLastTag,i=(d===a.backspace||d===a.left||d===a.right)&&0===b.newTag.text().length&&!m.enableEditingLastTag,f)k.addText(b.newTag.text());else if(l){var n;k.selectPrior(),n=k.removeSelected(),n&&b.newTag.text(n[m.displayProperty])}else g?k.removeSelected():i&&(d===a.left||d===a.backspace?k.selectPrior():d===a.right&&k.selectNext());(f||i||g||l)&&c.preventDefault()}}).on("input-paste",function(a){if(m.addOnPaste){var b=a.getTextData(),c=b.split(m.pasteSplitPattern);c.length>1&&(c.forEach(function(a){k.addText(a)}),a.preventDefault())}})}}}]),d.directive("tiTagItem",["tiUtil",function(a){return{restrict:"E",require:"^tagsInput",template:'<ng-include src="$$template"></ng-include>',scope:{data:"="},link:function(b,c,d,e){var f=e.registerTagItem(),g=f.getOptions();b.$$template=g.template,b.$$removeTagSymbol=g.removeTagSymbol,b.$getDisplayText=function(){return a.safeToString(b.data[g.displayProperty])},b.$removeTag=function(){f.removeTag(b.$index)},b.$watch("$parent.$index",function(a){b.$index=a})}}}]),d.directive("autoComplete",["$document","$timeout","$sce","$q","tagsInputConfig","tiUtil",function(b,c,d,e,f,g){function h(a,b,c){var f,h,i,d={};return i=function(){return b.tagsInput.keyProperty||b.tagsInput.displayProperty},f=function(a,c){return a.filter(function(a){return!g.findInObjectArray(c,a,i(),function(a,c){return b.tagsInput.replaceSpacesWithDashes&&(a=g.replaceSpacesWithDashes(a),c=g.replaceSpacesWithDashes(c)),g.defaultComparer(a,c)})})},d.reset=function(){h=null,d.items=[],d.visible=!1,d.index=-1,d.selected=null,d.query=null},d.show=function(){b.selectFirstMatch?d.select(0):d.selected=null,d.visible=!0},d.load=g.debounce(function(c,j){d.query=c;var k=e.when(a({$query:c}));h=k,k.then(function(a){k===h&&(a=g.makeObjectArray(a.data||a,i()),a=f(a,j),d.items=a.slice(0,b.maxResultsToShow),d.items.length>0?d.show():d.reset())})},b.debounceDelay),d.selectNext=function(){d.select(++d.index)},d.selectPrior=function(){d.select(--d.index)},d.select=function(a){a<0?a=d.items.length-1:a>=d.items.length&&(a=0),d.index=a,d.selected=d.items[a],c.trigger("suggestion-selected",a)},d.reset(),d}function i(a,b){var c=a.find("li").eq(b),d=c.parent(),e=c.prop("offsetTop"),f=c.prop("offsetHeight"),g=d.prop("clientHeight"),h=d.prop("scrollTop");e<h?d.prop("scrollTop",e):e+f>g+h&&d.prop("scrollTop",e+f-g)}return{restrict:"E",require:"^tagsInput",scope:{source:"&"},templateUrl:"ngTagsInput/auto-complete.html",controller:["$scope","$element","$attrs",function(a,b,c){a.events=g.simplePubSub(),f.load("autoComplete",a,c,{template:[String,"ngTagsInput/auto-complete-match.html"],debounceDelay:[Number,100],minLength:[Number,3],highlightMatchedText:[Boolean,!0],maxResultsToShow:[Number,10],loadOnDownArrow:[Boolean,!1],loadOnEmpty:[Boolean,!1],loadOnFocus:[Boolean,!1],toggleOnClick:[Boolean,!1],selectFirstMatch:[Boolean,!0],displayProperty:[String,""]}),a.suggestionList=new h(a.source,a.options,a.events),this.registerAutocompleteMatch=function(){return{getOptions:function(){return a.options},getQuery:function(){return a.suggestionList.query}}}}],link:function(b,c,d,e){var m,f=[a.enter,a.tab,a.escape,a.up,a.down],h=b.suggestionList,j=e.registerAutocomplete(),k=b.options,l=b.events;k.tagsInput=j.getOptions(),m=function(a){return a&&a.length>=k.minLength||!a&&k.loadOnEmpty},b.addSuggestionByIndex=function(a){h.select(a),b.addSuggestion()},b.addSuggestion=function(){var a=!1;return h.selected&&(j.addTag(angular.copy(h.selected)),h.reset(),j.focusInput(),a=!0),a},b.track=function(a){return a[k.tagsInput.keyProperty||k.tagsInput.displayProperty]},j.on("tag-added tag-removed invalid-tag input-blur",function(){b.hasFocus=!1,h.reset()}).on("input-change",function(a){m(a)&&!b.hasFocus?h.load(a,j.getTags()):h.reset()}).on("input-focus",function(){var a=j.getCurrentTagText();k.loadOnFocus&&m(a)&&(h.visible&&b.hasFocus?h.reset():h.load(a,j.getTags()),b.hasFocus=!b.hasFocus)}).on("input-blur",function(){h.reset()}).on("input-click",function(){if(k.toggleOnClick){var a=j.getCurrentTagText();h.visible?h.reset():h.load(a,j.getTags()),b.hasFocus=!b.hasFocus}}).on("input-keydown",function(c){var d=c.keyCode,e=!1;if(!g.isModifierOn(c)&&f.indexOf(d)!==-1)return h.visible?d===a.down?(h.selectNext(),e=!0):d===a.up?(h.selectPrior(),e=!0):d===a.escape?(h.reset(),e=!0):d!==a.enter&&d!==a.tab||(e=b.addSuggestion(),h.load(j.getCurrentTagText(),j.getTags())):d===a.down&&b.options.loadOnDownArrow&&(h.load(j.getCurrentTagText(),j.getTags()),e=!0),e?(c.preventDefault(),c.stopImmediatePropagation(),!1):void 0}),l.on("suggestion-selected",function(a){i(c,a)})}}}]),d.directive("tiAutocompleteMatch",["$sce","tiUtil",function(a,b){return{restrict:"E",require:"^autoComplete",template:'<ng-include src="$$template"></ng-include>',scope:{data:"="},link:function(c,d,e,f){var g=f.registerAutocompleteMatch(),h=g.getOptions();c.$$template=h.template,c.$index=c.$parent.$index,c.$highlight=function(c){return h.highlightMatchedText&&(c=b.safeHighlight(c,g.getQuery())),a.trustAsHtml(c)},c.$getDisplayText=function(){return b.safeToString(c.data[h.displayProperty||h.tagsInput.displayProperty])}}}}]),d.directive("tiTranscludeAppend",function(){return function(a,b,c,d,e){e(function(a){b.append(a)})}}),d.directive("tiAutosize",["tagsInputConfig",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var g,h,f=a.getTextAutosizeThreshold();g=angular.element('<span class="input"></span>'),g.css("display","none").css("visibility","hidden").css("width","auto").css("white-space","pre"),c.parent().append(g),h=function(a){var e,b=a;return angular.isString(b)&&0===b.length&&(b=d.placeholder),b&&(g.text(b),g.css("display",""),e=g.prop("offsetWidth"),g.css("display","none")),c.css("width",e?e+f+"px":""),a},e.$parsers.unshift(h),e.$formatters.unshift(h),d.$observe("placeholder",function(a){e.$modelValue||h(a)})}}}]),d.directive("tiBindAttrs",function(){return function(a,b,c){a.$watch(c.tiBindAttrs,function(a){angular.forEach(a,function(a,b){c.$set(b,a)})},!0)}}),d.provider("tagsInputConfig",function(){var a={},b={},c=3;this.setDefaults=function(b,c){return a[b]=c,this},this.setActiveInterpolation=function(a,c){return b[a]=c,this},this.setTextAutosizeThreshold=function(a){return c=a,this},this.$get=["$interpolate",function(d){var e={};return e[String]=function(a){return a},e[Number]=function(a){return parseInt(a,10)},e[Boolean]=function(a){return"true"===a.toLowerCase()},e[RegExp]=function(a){return new RegExp(a)},{load:function(c,f,g,h){var i=function(){return!0};f.options={},angular.forEach(h,function(h,j){var k,l,m,n,o,p;k=h[0],l=h[1],m=h[2]||i,n=e[k],o=function(){var b=a[c]&&a[c][j];return angular.isDefined(b)?b:l},p=function(a){f.options[j]=a&&m(a)?n(a):o()},b[c]&&b[c][j]?g.$observe(j,function(a){p(a),f.events.trigger("option-change",{name:j,newValue:a})}):p(g[j]&&d(g[j])(f.$parent))})},getTextAutosizeThreshold:function(){return c}}}]}),d.factory("tiUtil",["$timeout",function(a){var b={};return b.debounce=function(b,c){var d;return function(){var e=arguments;a.cancel(d),d=a(function(){b.apply(null,e)},c)}},b.makeObjectArray=function(a,b){if(!angular.isArray(a)||0===a.length||angular.isObject(a[0]))return a;var c=[];return a.forEach(function(a){var d={};d[b]=a,c.push(d)}),c},b.findInObjectArray=function(a,c,d,e){var f=null;return e=e||b.defaultComparer,a.some(function(a){if(e(a[d],c[d]))return f=a,!0}),f},b.defaultComparer=function(a,c){return b.safeToString(a).toLowerCase()===b.safeToString(c).toLowerCase()},b.safeHighlight=function(a,c){function d(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}if(!c)return a;a=b.encodeHTML(a),c=b.encodeHTML(c);var e=new RegExp("&[^;]+;|"+d(c),"gi");return a.replace(e,function(a){return a.toLowerCase()===c.toLowerCase()?"<em>"+a+"</em>":a})},b.safeToString=function(a){return angular.isUndefined(a)||null==a?"":a.toString().trim()},b.encodeHTML=function(a){return b.safeToString(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},b.handleUndefinedResult=function(a,b){return function(){var c=a.apply(null,arguments);return angular.isUndefined(c)?b:c}},b.replaceSpacesWithDashes=function(a){return b.safeToString(a).replace(/\s/g,"-")},b.isModifierOn=function(a){return a.shiftKey||a.ctrlKey||a.altKey||a.metaKey},b.simplePubSub=function(){var a={};return{on:function(b,c){return b.split(" ").forEach(function(b){a[b]||(a[b]=[]),a[b].push(c)}),this},trigger:function(c,d){var e=a[c]||[];return e.every(function(a){return b.handleUndefinedResult(a,!0)(d)}),this}}},b}]),d.run(["$templateCache",function(a){a.put("ngTagsInput/tags-input.html",'<div class="host" tabindex="-1" ng-click="eventHandlers.host.click()" ti-transclude-append><div class="tags" ng-class="{focused: hasFocus}"><ul class="tag-list"><li class="tag-item" ng-repeat="tag in tagList.items track by track(tag)" ng-class="{ selected: tag == tagList.selected }" ng-click="eventHandlers.tag.click(tag)"><ti-tag-item data="::tag"></ti-tag-item></li></ul><input class="input" autocomplete="off" ng-model="newTag.text" ng-model-options="{getterSetter: true}" ng-click="eventHandlers.input.click($event)" ng-keydown="eventHandlers.input.keydown($event)" ng-focus="eventHandlers.input.focus($event)" ng-blur="eventHandlers.input.blur($event)" ng-paste="eventHandlers.input.paste($event)" ng-trim="false" ng-class="{\'invalid-tag\': newTag.invalid}" ng-disabled="disabled" ti-bind-attrs="{type: options.type, placeholder: options.placeholder, tabindex: options.tabindex, spellcheck: options.spellcheck}" ti-autosize></div></div>'),a.put("ngTagsInput/tag-item.html",'<span ng-bind="$getDisplayText()"></span> <a class="remove-button" ng-click="$removeTag()" ng-bind="::$$removeTagSymbol"></a>'),a.put("ngTagsInput/auto-complete.html",'<div class="autocomplete" ng-if="suggestionList.visible"><ul class="suggestion-list"><li class="suggestion-item" ng-repeat="item in suggestionList.items track by track(item)" ng-class="{selected: item == suggestionList.selected}" ng-click="addSuggestionByIndex($index)" ng-mouseenter="suggestionList.select($index)"><ti-autocomplete-match data="::item"></ti-autocomplete-match></li></ul></div>'),a.put("ngTagsInput/auto-complete-match.html",'<span ng-bind-html="$highlight($getDisplayText())"></span>')}])}();
